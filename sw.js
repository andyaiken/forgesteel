const a=self,c=new Date().toISOString().replace(/[:.]/g,"-"),r=`forgesteel-${c}`,i=["/forgesteel/","/forgesteel/index.html","/forgesteel/manifest.json"];self.addEventListener("install",n=>{n.waitUntil(caches.open(r).then(e=>e.addAll(i)).then(()=>a.skipWaiting()).catch(e=>{console.error("Service Worker installation failed:",e)}))});self.addEventListener("activate",n=>{n.waitUntil(caches.keys().then(e=>Promise.all(e.filter(s=>s!==r).map(s=>caches.delete(s)))).then(()=>a.clients.claim()))});self.addEventListener("fetch",n=>{const t=n;t.request.method==="GET"&&t.request.url.startsWith("http")&&t.respondWith((async()=>{try{const e=await fetch(t.request);return e&&e.status===200&&t.request.url.includes("/forgesteel/")&&await(await caches.open(r)).put(t.request,e.clone()),e}catch{const e=await caches.match(t.request);if(e)return e;if(t.request.destination==="document"){const s=await caches.match("/forgesteel/index.html");if(s)return s}return new Response("Offline - content not available",{status:503})}})())});self.addEventListener("sync",n=>{n.tag});self.addEventListener("push",n=>{const t=n;if(t.data){const e=t.data.json(),s={body:e.body,icon:"/forgesteel/src/assets/shield.png",badge:"/forgesteel/src/assets/shield.png",data:{dateOfArrival:Date.now(),primaryKey:1}};t.waitUntil(a.registration.showNotification(e.title,s))}});
